{"remainingRequest":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\ts-loader\\index.js??ref--12-2!C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\src\\components\\ChatLineView.vue?vue&type=script&lang=ts&","dependencies":[{"path":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\src\\components\\ChatLineView.vue","mtime":1551843196655},{"path":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\ts-loader\\index.js","mtime":1545640398000},{"path":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import Vue from \"vue\";\r\nimport TQGlobals from \"../classes/TQGlobals\";\r\nimport IfDebug from \"./IfDebug.vue\";\r\nimport TimeStamp from \"./TimeStamp.vue\";\r\nimport PriceDeviationView from \"./PriceDeviationView.vue\";\r\nexport default Vue.extend({\r\n    props: {\r\n        chatLine: {\r\n            type: Object,\r\n            required: true\r\n        },\r\n        showTimestamp: {\r\n            type: Boolean,\r\n            required: true\r\n        },\r\n        itemNameLinks: {\r\n            type: Boolean,\r\n            required: true\r\n        },\r\n        itemNameToHighlight: {\r\n            type: String,\r\n            required: false\r\n        }\r\n    },\r\n    watch: {\r\n        chatLine: function (newValue, oldValue) {\r\n            this.rebuildText();\r\n        }\r\n    },\r\n    mounted: function () {\r\n        this.rebuildText();\r\n    },\r\n    methods: {\r\n        rebuildText: function () {\r\n            var textSpan = this.$el.querySelector(\".tqChatLineView_PlayerText\");\r\n            // remove whatever text we built in there last time\r\n            while (textSpan.lastChild) {\r\n                textSpan.removeChild(textSpan.lastChild);\r\n            }\r\n            textSpan.appendChild(document.createTextNode(\"'\"));\r\n            var indexedItemNames = new Array(); // used when adding PriceDeviationComponents\r\n            var unparsedText = this.chatLine.text;\r\n            var textSoFar = \"\";\r\n            var _loop_1 = function () {\r\n                if (unparsedText.substring(0, TQGlobals.settings.outerChatToken.length) === TQGlobals.settings.outerChatToken) {\r\n                    // the next word is a special data token\r\n                    // create a text span for the player-typed words we've found up to this point in the loop\r\n                    var playerTextSpan = document.createElement(\"span\");\r\n                    playerTextSpan.innerHTML = this_1.htmlEncode(textSoFar);\r\n                    textSpan.appendChild(playerTextSpan);\r\n                    textSoFar = \"\"; // reset textSoFar for the next iteration after the token\r\n                    // parse the token\r\n                    var endTokenIndex = unparsedText.indexOf(TQGlobals.settings.outerChatToken, TQGlobals.settings.outerChatToken.length);\r\n                    var tokenString = unparsedText.substring(TQGlobals.settings.outerChatToken.length, endTokenIndex);\r\n                    var tokenParts = tokenString.split(TQGlobals.settings.innerChatToken);\r\n                    if (tokenParts[0] == \"item\") {\r\n                        // item name token\r\n                        var isKnownItem = (tokenParts[1] == \"1\");\r\n                        var itemName = tokenParts[2].replace(/_/g, \" \");\r\n                        var urlEncodedItemName_1 = encodeURIComponent(itemName);\r\n                        indexedItemNames.push(itemName);\r\n                        if (this_1.itemNameLinks) {\r\n                            // make the item name a clickable link\r\n                            var linkElem = document.createElement(\"a\");\r\n                            linkElem.classList.add(isKnownItem ? \"tqKnownItemLink\" : \"tqUnknownItemLink\");\r\n                            linkElem.href = \"/item/\" + urlEncodedItemName_1;\r\n                            var thisComponent_1 = this_1;\r\n                            linkElem.addEventListener(\"click\", function (e) {\r\n                                e.preventDefault();\r\n                                thisComponent_1.$router.push(\"/item/\" + urlEncodedItemName_1);\r\n                            });\r\n                            linkElem.text = itemName;\r\n                            textSpan.appendChild(linkElem);\r\n                        }\r\n                        else if (this_1.itemNameToHighlight == itemName) {\r\n                            // highlight the item name without making it a clickable link\r\n                            var spanElem = document.createElement(\"span\");\r\n                            spanElem.classList.add(isKnownItem ? \"tqKnownItemLink\" : \"tqUnknownItemLink\");\r\n                            spanElem.innerHTML = this_1.htmlEncode(itemName);\r\n                            textSpan.appendChild(spanElem);\r\n                        }\r\n                        else {\r\n                            textSoFar += itemName;\r\n                        }\r\n                    }\r\n                    else if (tokenParts[0] == \"price\") {\r\n                        // price token\r\n                        var isBuying = (tokenParts[1] == \"1\");\r\n                        var price = parseInt(tokenParts[2]);\r\n                        var itemIndexes = tokenParts[3].split(',');\r\n                        var playerTypedPriceText = tokenParts[4];\r\n                        // render the text that the player actually typed in chat\r\n                        var priceElem = document.createElement(\"span\");\r\n                        priceElem.innerHTML = this_1.htmlEncode(playerTypedPriceText);\r\n                        textSpan.appendChild(priceElem);\r\n                        // now create a PriceDeviationView for each item associated with this price\r\n                        for (var _i = 0, itemIndexes_1 = itemIndexes; _i < itemIndexes_1.length; _i++) {\r\n                            var itemNameIndexString = itemIndexes_1[_i];\r\n                            var itemName = indexedItemNames[parseInt(itemNameIndexString)];\r\n                            var priceDeviationElem = document.createElement(\"span\");\r\n                            textSpan.appendChild(priceDeviationElem);\r\n                            var priceDeviationView = new PriceDeviationView({\r\n                                propsData: {\r\n                                    priceHistory: TQGlobals.priceHistories.get(itemName, false),\r\n                                    price: price,\r\n                                    isBuying: isBuying\r\n                                }\r\n                            });\r\n                            priceDeviationView.$mount(priceDeviationElem);\r\n                        }\r\n                    }\r\n                    else {\r\n                        // unrecognized token\r\n                        throw new Error(\"Unrecognized chat token: \" + tokenString);\r\n                    }\r\n                    // update unparsedText\r\n                    var nextIndex = endTokenIndex + TQGlobals.settings.outerChatToken.length;\r\n                    if (nextIndex < unparsedText.length)\r\n                        unparsedText = unparsedText.substring(nextIndex);\r\n                    else\r\n                        unparsedText = \"\";\r\n                }\r\n                else {\r\n                    textSoFar += unparsedText[0];\r\n                    // updated unparsedText\r\n                    unparsedText = unparsedText.substring(1);\r\n                }\r\n            };\r\n            var this_1 = this;\r\n            while (unparsedText.length > 0) {\r\n                _loop_1();\r\n            }\r\n            if (textSoFar != \"\") {\r\n                var playerTextSpan = document.createElement(\"span\");\r\n                playerTextSpan.innerHTML = this.htmlEncode(textSoFar);\r\n                textSpan.appendChild(playerTextSpan);\r\n            }\r\n            textSpan.appendChild(document.createTextNode(\"'\"));\r\n        },\r\n        htmlEncode: function (str) {\r\n            return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/ /g, '&nbsp;');\r\n        }\r\n    },\r\n    components: {\r\n        IfDebug: IfDebug,\r\n        TimeStamp: TimeStamp\r\n    }\r\n});\r\n",{"version":3,"file":"C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\src\\components\\ChatLineView.vue.ts","sourceRoot":"","sources":["C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\joe\\source\\repos\\TunnelQuest\\TunnelQuest.Web\\SPA\\src\\components\\ChatLineView.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from \"vue\";\n\nimport ChatLine from \"../interfaces/ChatLine\";\n\nimport TQGlobals from \"../classes/TQGlobals\";\n\nimport IfDebug from \"./IfDebug.vue\";\nimport TimeStamp from \"./TimeStamp.vue\";\nimport PriceDeviationView from \"./PriceDeviationView.vue\";\n\nexport default Vue.extend({\n    props: {\n        chatLine: {\n            type: Object as () => ChatLine,\n            required: true\n        },\n        showTimestamp: {\n            type: Boolean,\n            required: true\n        },\n        itemNameLinks: {\n            type: Boolean,\n            required: true\n        },\n        itemNameToHighlight: {\n            type: String,\n            required: false\n        }\n    },\n    watch: {\n        chatLine: function (newValue, oldValue) {\n            this.rebuildText();\n        }\n    },\n    mounted: function () {\n        this.rebuildText();\n    },\n    methods: {\n\n        rebuildText: function () {\n            let textSpan = this.$el.querySelector(\".tqChatLineView_PlayerText\") as HTMLSpanElement;\n\n            // remove whatever text we built in there last time\n            while (textSpan.lastChild) {\n                textSpan.removeChild(textSpan.lastChild);\n            }\n\n            textSpan.appendChild(document.createTextNode(\"'\"));\n\n            let indexedItemNames = new Array<string>(); // used when adding PriceDeviationComponents\n            let unparsedText = this.chatLine.text;\n            let textSoFar = \"\"\n            while (unparsedText.length > 0) {\n\n                if (unparsedText.substring(0, TQGlobals.settings.outerChatToken.length) === TQGlobals.settings.outerChatToken) {\n                    // the next word is a special data token\n\n                    // create a text span for the player-typed words we've found up to this point in the loop\n                    let playerTextSpan = document.createElement(\"span\") as HTMLSpanElement;\n                    playerTextSpan.innerHTML = this.htmlEncode(textSoFar);\n                    textSpan.appendChild(playerTextSpan);\n                    textSoFar = \"\"; // reset textSoFar for the next iteration after the token\n\n                    // parse the token\n                    let endTokenIndex = unparsedText.indexOf(TQGlobals.settings.outerChatToken, TQGlobals.settings.outerChatToken.length);\n                    let tokenString = unparsedText.substring(TQGlobals.settings.outerChatToken.length, endTokenIndex);\n                    let tokenParts = tokenString.split(TQGlobals.settings.innerChatToken);\n\n                    if (tokenParts[0] == \"item\") {\n                        // item name token\n\n                        let isKnownItem = (tokenParts[1] == \"1\");\n                        let itemName = tokenParts[2].replace(/_/g, \" \");\n                        let urlEncodedItemName = encodeURIComponent(itemName);\n\n                        indexedItemNames.push(itemName);\n\n                        if (this.itemNameLinks) {\n                            // make the item name a clickable link\n                            let linkElem = document.createElement(\"a\") as HTMLAnchorElement;\n                            linkElem.classList.add(isKnownItem ? \"tqKnownItemLink\" : \"tqUnknownItemLink\");\n                            linkElem.href = \"/item/\" + urlEncodedItemName;\n                            let thisComponent = this;\n                            linkElem.addEventListener(\"click\", function (e) {\n                                e.preventDefault();\n                                thisComponent.$router.push(\"/item/\" + urlEncodedItemName);\n                            });\n\n                            linkElem.text = itemName;\n                            textSpan.appendChild(linkElem);\n                        }\n                        else if (this.itemNameToHighlight == itemName) {\n                            // highlight the item name without making it a clickable link\n                            let spanElem = document.createElement(\"span\") as HTMLSpanElement;\n                            spanElem.classList.add(isKnownItem ? \"tqKnownItemLink\" : \"tqUnknownItemLink\");\n                            spanElem.innerHTML = this.htmlEncode(itemName);\n                            textSpan.appendChild(spanElem);\n                        }\n                        else {\n                            textSoFar += itemName;\n                        }\n\n                    }\n                    else if (tokenParts[0] == \"price\") {\n                        // price token\n\n                        let isBuying = (tokenParts[1] == \"1\");\n                        let price = parseInt(tokenParts[2]);\n                        let itemIndexes = tokenParts[3].split(',');\n                        let playerTypedPriceText = tokenParts[4];\n\n                        // render the text that the player actually typed in chat\n                        let priceElem = document.createElement(\"span\") as HTMLSpanElement;\n                        priceElem.innerHTML = this.htmlEncode(playerTypedPriceText);\n                        textSpan.appendChild(priceElem);\n\n                        // now create a PriceDeviationView for each item associated with this price\n                        for (let itemNameIndexString of itemIndexes) {\n                            let itemName = indexedItemNames[parseInt(itemNameIndexString)];\n                            let priceDeviationElem = document.createElement(\"span\") as HTMLSpanElement;\n                            textSpan.appendChild(priceDeviationElem);\n                            let priceDeviationView = new PriceDeviationView({\n                                propsData: {\n                                    priceHistory: TQGlobals.priceHistories.get(itemName, false),\n                                    price: price,\n                                    isBuying: isBuying\n                                }\n                            });\n                            priceDeviationView.$mount(priceDeviationElem);\n                        }\n                    }\n                    else {\n                        // unrecognized token\n                        throw new Error(\"Unrecognized chat token: \" + tokenString);\n                    }\n\n                    // update unparsedText\n                    let nextIndex = endTokenIndex + TQGlobals.settings.outerChatToken.length;\n                    if (nextIndex < unparsedText.length)\n                        unparsedText = unparsedText.substring(nextIndex);\n                    else\n                        unparsedText = \"\";\n                }\n                else {\n                    textSoFar += unparsedText[0];\n                    // updated unparsedText\n                    unparsedText = unparsedText.substring(1);\n                }\n                \n            }\n\n            if (textSoFar != \"\") {\n                let playerTextSpan = document.createElement(\"span\") as HTMLSpanElement;\n                playerTextSpan.innerHTML = this.htmlEncode(textSoFar);\n                textSpan.appendChild(playerTextSpan);\n            }\n\n            textSpan.appendChild(document.createTextNode(\"'\"));\n        },\n\n        htmlEncode: function (str: string) {\n            return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/ /g, '&nbsp;');\n        }\n    },\n    components: {\n        IfDebug,\n        TimeStamp\n    }\n});\n"]}]}